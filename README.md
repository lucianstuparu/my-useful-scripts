
# Useful Scripts Collection

This repository contains scripts for various tasks, including API interaction, data processing, and automation, particularly for Learning Passport instances. Below is a list of all scripts, their purposes, and instructions on how to run them.

---

## 1. Retrieve All Groups

- **Purpose:** Fetch all groups from a Learning Passport instance and save their `Group ID` and `Group Name` into a CSV file.
- **File:** `retrieve_groups.py`
- **How to Run:**
  ```bash
  python retrieve_groups.py <INSTANCE_URL> <OUTPUT_DIRECTORY> <ACCESS_TOKEN>
  ```
  Example:
  ```bash
  python retrieve_groups.py "https://madristi.mehe.gov.lb" "./output" "your_access_token_here"
  ```
  - `<INSTANCE_URL>`: The base URL of the Learning Passport instance (e.g., `https://madristi.mehe.gov.lb`).
  - `<OUTPUT_DIRECTORY>`: Path to the directory where the output CSV will be saved.
  - `<ACCESS_TOKEN>`: API access token for authentication.

  **Output:** A file named `<instance>_all_groups_<date_time>.csv` in the specified directory.

---

## 2. Extract Groups by Naming Convention

- **Purpose:** Process a groups CSV file to filter groups matching a specific naming convention (`SchoolID-Grade-Language-*`). Outputs a CSV file with additional columns for `Grade` and `Language`.
- **File:** `extract_groups.py`
- **How to Run:**
  ```bash
  python extract_groups.py <INPUT_FILE> <OUTPUT_DIRECTORY>
  ```
  Example:
  ```bash
  python extract_groups.py "./output/madristi_all_groups_03-12-2024__12-33-22.csv" "./filtered"
  ```
  - `<INPUT_FILE>`: Path to the CSV file containing all groups (e.g., generated by `retrieve_groups.py`).
  - `<OUTPUT_DIRECTORY>`: Path to the directory where the filtered CSV will be saved.

  **Output:** A file named `filtered_groups_<date_time>.csv` in the specified directory.

---

## 3. Assign Courses to Groups

- **Purpose:** Assign courses to groups in a Learning Passport instance based on matching `Grade` and `Language`. Groups and courses are provided as CSV inputs. Each course is assigned to all matching groups via API calls, batched by group.
- **File:** `assign_courses.py`
- **How to Run:**
  ```bash
  python assign_courses.py <INSTANCE_URL> <INPUT_COURSES_FILE> <INPUT_GROUPS_FILE> <OUTPUT_DIRECTORY> <ACCESS_TOKEN>
  ```
  Example:
  ```bash
  python assign_courses.py "https://madristi.mehe.gov.lb" "./courses-test.csv" "./filtered_groups.csv" "./output" "your_access_token_here"
  ```
  - `<INSTANCE_URL>`: The base URL of the Learning Passport instance (e.g., `https://madristi.mehe.gov.lb`).
  - `<INPUT_COURSES_FILE>`: Path to the CSV file containing courses (columns: `Course ID`, `Grade`, `Language`).
  - `<INPUT_GROUPS_FILE>`: Path to the CSV file containing filtered groups.
  - `<OUTPUT_DIRECTORY>`: Path to the directory where the result CSV will be saved.
  - `<ACCESS_TOKEN>`: API access token for authentication.

  **Output:** A file named `course_assignments_<date_time>.csv` in the specified directory, logging course assignments.

---

## 4. Get Number of Groups

- **Purpose:** Retrieve and print the total number of groups from the specified Learning Passport instance.
- **File:** `get_groups.py`
- **How to Run:**
  ```bash
  python get_groups.py <INSTANCE_URL> <ACCESS_TOKEN>
  ```
  Example:
  ```bash
  python get_groups.py "https://madristi.mehe.gov.lb" "your_access_token_here"
  ```
  - `<INSTANCE_URL>`: The base URL of the Learning Passport instance.
  - `<ACCESS_TOKEN>`: API access token for authentication.

  **Output:** Prints the number of groups directly to the command line.

---

### Notes
- Replace `<INSTANCE_URL>` with your instance's base URL (e.g., `https://madristi.mehe.gov.lb`).
- Replace `<ACCESS_TOKEN>` with your API access token.
- Replace `<INPUT_COURSES_FILE>` and `<INPUT_GROUPS_FILE>` with the paths to your input CSV files.
- Replace `<OUTPUT_DIRECTORY>` with the desired directory path for output files.

### Prerequisites
- Python 3.x installed on your machine.
- The `requests` library installed. Install it using:
  ```bash
  pip install requests
  ```

Let me know if additional details are needed!

---

## 5. Convert PowerPoint to HTML

- **Purpose:** Convert PowerPoint files (`.pptx`) to HTML using the iSpring executable. Supports batch processing for all files in a directory.
- **File:** `convert-ppt-to-html.py`
- **How to Run:**
  ```bash
  python convert-ppt-to-html.py <ISPRING_EXE_PATH> <INPUT_FOLDER_OR_FILE>
  ```
  Example:
  ```bash
  python convert-ppt-to-html.py "C:\path\to\ispring.exe" "C:\path\to\pptx-folder"
  ```
  - `<ISPRING_EXE_PATH>`: Path to the iSpring executable.
  - `<INPUT_FOLDER_OR_FILE>`: Path to a directory containing `.pptx` files or a single `.pptx` file.

  **Output:** Each `.pptx` file is converted to an HTML file (`index.html`) and a corresponding ZIP file in the same directory.

---

## 6. Merge H5P (Numbered HTML) Files

- **Purpose:** Merge numbered H5P (HTML) files in a directory into a single `index.html`, preserving order and embedding each file in an iframe structure.
- **File:** `merge_html_files.py`
- **How to Run:**
  ```bash
  python merge_html_files.py <DIRECTORY_PATH>
  ```
  Example:
  ```bash
  python merge_html_files.py "C:\path\to\h5p-directory"
  ```
  - `<DIRECTORY_PATH>`: Path to the directory containing numbered H5P (HTML) files.

  **Output:** A single `index.html` file in the specified directory with all H5P files embedded.

---

## 7. Replace Variables in Text File

- **Purpose:** Replace variables in a text file (`{{variable_name}}`) with values from a configuration file.
- **File:** `replace_variables.py`
- **How to Run:**
  ```bash
  python replace_variables.py <CONFIG_PATH> <INPUT_FILE> <OUTPUT_FILE>
  ```
  Example:
  ```bash
  python replace_variables.py "config.txt" "input.txt" "output.txt"
  ```
  - `<CONFIG_PATH>`: Path to the configuration file containing `key=value` pairs.
  - `<INPUT_FILE>`: Path to the input text file with placeholders (`{{variable_name}}`).
  - `<OUTPUT_FILE>`: Path to save the processed file with placeholders replaced.

  **Output:** A processed file with all placeholders replaced by corresponding values from the config file.

---

### Prerequisites for All Scripts
- Python 3.x installed on your machine.
- Additional dependencies:
  - Install `requests` library for scripts interacting with APIs:
    ```bash
    pip install requests
    ```

Let me know if further adjustments are needed!
